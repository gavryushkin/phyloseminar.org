Beneficial and deleterious mutations cause the fitness of lineages to vary across a phylogeny and thereby shape its branching structure. While standard phylogenetic models do not allow non-neutral mutations to feedback and shape trees, birth-death models can account for this feedback by letting the fitness of lineages depend on their type. To date however, these multi-type birth-death models have only been applied to cases where a lineage's fitness is determined by a single evolving character state. We extend these models to track the fitness of a lineage and sequence evolution at multiple sites. This approach remains computationally tractable by tracking the fitness and ancestral genotype of lineages probabilistically in an approximate manner. Although approximate, we show that we can accurately estimate the fitness of lineages and even specific mutation effects from phylogenies. We apply this approach to estimate the population-level fitness effects of mutations previously identified to modulate the fitness of Ebola virus and human influenza viruses in the lab.
